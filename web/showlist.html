<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Show todo list</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <script>$(function(){$('#navbar').load('navbar.html');});</script>

    <script>
        function populateList(listID)
        {
            $.ajax({
                url: 'todolist/get-list',
                method: 'GET',
                success: function(response) {
                    var list = document.getElementById(listID);
                    var items = response['items'];
                    if (items.length == 0)
                    {
                        var li=document.createElement('li');
                        li.className = 'list-group-item list-group-item-action p-2';
                        li.innerHTML = '<div class="w-100"><h3>Your to-do list is empty!</h3><h4>Time to go outside and touch grass</h4></div>';
                        list.appendChild(li);
                    }
                    for (var i = 0; i < items.length; ++i) {
                        if (i>0) {
                            var gap=document.createElement('li');
                            gap.className = 'list-group-item bg-dark-subtle p-1';
                            list.appendChild(gap);
                        }
                        var li=document.createElement('li');
                        li.className = 'list-group-item list-group-item-action p-2';
                        li.innerHTML = '<div class="d-flex w-100 justify-content-between border-bottom">\n' +
                            '<h5 class="mb-1 text-muted">'+items[i]['title']+'</h5>\n' +
                            '<small class="text-muted">'+items[i]['deadline']+'</small>\n' +
                            '</div>\n' +
                            '<div class="mt-2">'+items[i]['description']+'</div>';   // Use innerHTML to set the text
                        list.appendChild(li);
                    }
                },
                error: function(xhr, status, error) {
                    alert(status + ':' + error);
                }
            });
        }
    </script>

</head>
<body>

    <div id="navbar"></div>

    <div class="container p-3">
        <h2 class="text-muted">Your to-do list</h2>
        <div class="bg-dark-subtle p-3">
            <ul class="list-group list-group-flush" id="todoList">
                <script>populateList('todoList')</script>
            </ul>
            <button type="button" class="btn btn-primary rounded-pill mt-3 w-100 p-0 fw-bold" style="font-size: xx-large">+</button>
        </div>
    </div>
</body>
</html>